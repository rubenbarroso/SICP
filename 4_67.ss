;One way to detect loops is to memoize pairs of (query, frame). If the interpreter come across and already-visited (query, frame), then it
;will stop the processing